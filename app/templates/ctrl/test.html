{% set page = 'test' %}
{% extends "ctrl/base.html" %}
{% import "bootstrap/wtf.html" as wtf %}
{% import "_macros.html" as macros %}
{% block title %}Temporary Test Page - MMSE{% endblock %}

{% block page_content %}
<div class="page-header">
  <h1>Test Page</h1>
</div>
<div>

<form>
  <div class="form-group" id="uploads-control">
    <label for="image" class="label-block">Image</label>
    <input type="text" class="form-control typeahead" id="image" placeholder="Image">
  </div>
  <button type="submit" class="btn btn-default">Submit</button>
</form>

</div>
{% endblock %}

{% block scripts %}
{{ super() }}
{{ pagedown.include_pagedown() }}

{# Final solution for Firefox, Chrome #}
<script>
  var uploads = new Bloodhound({
    datumTokenizer: Bloodhound.tokenizers.whitespace,
    queryTokenizer: Bloodhound.tokenizers.whitespace,
    prefetch: "..{{ url_for('api.get_uploads_list') }}"
  });

  $('#uploads-control .typeahead').typeahead({
    hint: true,
    highlight: true,
  },
  {
    name: 'uploads',
    limit: 10,
    source: uploads
  });
</script>

{# Working Solution for Firefox, Chrome  #}
{#
<script>
  var uploads = new Bloodhound({
    datumTokenizer: Bloodhound.tokenizers.obj.whitespace('name'),
    queryTokenizer: Bloodhound.tokenizers.whitespace,
    prefetch: {
      url: "..{{ url_for('api.get_uploads_list2') }}",
      filter: function(list) {
        return $.map(list.uploads, function(upload) {
          return { name: upload }; });
      }
    }
  });

  uploads.initialize();

  $('#uploads-control .typeahead').typeahead({
    hint: true,
    highlight: true,
  },
  {
    name: 'uploads',
    limit: 10,
    displayKey: 'name',
    valueKey: 'name',
    source: uploads.ttAdapter()
  });
</script>
#}

{# Working Solution for Safari #}
{#
<script>
  var uploads = new Bloodhound({
    datumTokenizer: Bloodhound.tokenizers.whitespace,
    queryTokenizer: Bloodhound.tokenizers.whitespace,
    prefetch: "..{{ url_for('api.get_uploads_list2') }}"
  });

  $('#uploads-control .typeahead').typeahead({
    hint: true,
    highlight: true,
  },
  {
    name: 'uploads',
    limit: 10,
    source: uploads
  });
</script>
#}

<script>
  $(function () {
    $('#datetimepicker1').datetimepicker();
  });
</script>
{% endblock %}
