{% if recipient %}
<div class="comment-control">
	<input name="checkbox_select_all" id="select_all" type="checkbox" value=""></span>
	<button class="btn btn-default btn-sm on-check" data-action="read">Mark as read</button>
        <button class="btn btn-default btn-sm on-check" data-action="unread">Mark as not read</span></button>
</div>
{% endif %}

<ul class="ctrl-list">
  {% for ack in messages %}
    <li id="message{{ ack.message.id }}" class="ctrl-item {% if not ack.read %}unread{% endif%}">
        <div class="ctrl-item-thumbnail">
            <a href="{{ url_for('.user', username=ack.message.author.username) }}">
                <img class="img-rounded profile-thumbnail" src="{{ ack.message.author.gravatar(size=40) }}">
            </a>
        </div>

	{% if recipient %}
	<div class="ctrl-item-checkbox">
	  <input name="checkbox{{ ack.id }}" id="checkbox{{ ack.id }}" class="ctrl-item-select" type="checkbox" value="{{ ack.id }}">
	</div>
	{% endif %}

	
        <div class="ctrl-item-content">
            <div class="ctrl-item-date">{{ moment(ack.message.timestamp).fromNow() }}</div>
            <div class="ctrl-item-author">
	      <a href="{{ url_for('.user', username=ack.message.author.username) }}">
		{{ ack.message.author.username }}
	      </a>
	      <a href="{{ url_for('main.message', username=ack.recipient.username, id=ack.id) }}">
		{{ ack.message.title }}
	      </a>
	    </div>

            <div class="ctrl-item-body">
	      <span class="{% if comment.screened %}text-muted{% endif %}">
                {% if comment.body_html %}
                  {{ comment.body_html | safe }}
                {% else %}
                  {{ comment.body }}
                {% endif %}
	      </span>
            </div>

	    {% if recipient %}
 	    {% if ack.read == True %}
	    <button class="btn btn-danger btn-xs unread" type="button" title="Mark message as unread" data-action="unread" data-id-removal="{{ ack.id }}">Unread</button>
	    {% else %}
	    <button class="btn btn-default btn-xs read" type="button" title="Mark message as read" data-action="read" data-id-removal="{{ ack.id }}">Read</button>
	    {% endif %}
	    {% endif %}
        </div>
    </li>
    {% endfor %}
</ul>
